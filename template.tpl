___INFO___

{
  "displayName": "LiveRamp ATS Template",
  "description": "LiveRamp - Authenticated Traffic Solution",
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/jpeg;base64,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",
    "displayName": "",
    "id": "brand_dummy"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "valueValidators": [
      {
        "args": [
          "^https://.*"
        ],
        "enablingConditions": [],
        "errorMessage": "The URL must start with \"https://\"",
        "type": "REGEX"
      }
    ],
    "displayName": "deployment source url",
    "defaultValue": "https://d3kfooo0914kwr.cloudfront.net/ats.js",
    "simpleValueType": true,
    "name": "url",
    "type": "TEXT"
  },
  {
    "help": "LiveRamp provided partner id",
    "valueValidators": [
      {
        "type": "NON_NEGATIVE_NUMBER"
      },
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "NON_EMPTY"
      }
    ],
    "displayName": "placement id",
    "simpleValueType": true,
    "name": "placement id",
    "type": "TEXT"
  },
  {
    "help": "Log debug messages to console",
    "simpleValueType": true,
    "name": "debug",
    "checkboxText": "debug",
    "type": "CHECKBOX"
  }
]


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://*.cloudfront.net/ats.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Require the necessary APIs
const logToConsole = require('logToConsole');
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');

// Get the URL the user input into the text field
const url = data.url;

// If the user chose to log debug output, initialize the logging method
const log = data.debug ? logToConsole : (() => {});

log('LiveRamp: Loading script from ' + url);

// If the script loaded successfully, log a message and signal success
const onSuccess = () => {
  log('LiveRamp: Script loaded successfully.');
  data.gtmOnSuccess();
};

// If the script fails to load, log a message and signal failure
const onFailure = () => {
  log('LiveRamp: Script load failed.');
  data.gtmOnFailure();
};

// If the URL input by the user matches the permissions set for the template,
// inject the script with the onSuccess and onFailure methods as callbacks.
if (queryPermission('inject_script', url)) {
  injectScript(url, onSuccess, onFailure);
} else {
  log('LiveRamp: Script load failed due to permissions mismatch.');
  data.gtmOnFailure();
}


___NOTES___

Created on 8/20/2019, 5:43:48 PM
